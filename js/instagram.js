var Instagram=function(){var t=[],e=function(t){for(var e in t)for(var i=0,a=t[e].srclist.length;a>i;i++){var n=t[e].bigSrclist[i],o=new Image;o.src=n}},i=function(t){for(var i in t){for(var a="",n=0,o=t[i].srclist.length;o>n;n++)a+='<li>								<div class="img-box">									<a class="img-bg" rel="example_group" href="'+t[i].bigSrclist[n]+'" title="'+t[i].text[n]+'"></a>									<img lazy-src="'+t[i].srclist[n]+'" alt="">								</div>							</li>';$('<section class="archives album"><h1 class="year">'+t[i].year+"<em>"+t[i].month+'月</em></h1>				<ul class="img-box-ul">'+a+"</ul>				</section>").appendTo($(".instagram"))}$(".instagram").lazyload(),r(),setTimeout(function(){e(t)},3e3),$("a[rel=example_group]").fancybox()},a=function(t){if(t.indexOf("outbound-distilleryimage")>=0){var e=t.match(/outbound-distilleryimage([\s\S]*?)\//)[1],i=t.split("/");return"http://distilleryimage"+e+".ak.instagram.com/"+i[i.length-1]}var a="http://photos-g.ak.instagram.com/hphotos-ak-xpf1/",i=t.split("/");return a+i[i.length-1]},n=function(t){for(var e={},n=0,o=t.length;o>n;n++){var r=new Date(1e3*t[n].created_time),s=r.getFullYear(),l=r.getMonth()+1,c=a(t[n].images.low_resolution.url),u=a(t[n].images.standard_resolution.url),g="";t[n].caption&&t[n].caption.text&&(g=t[n].caption.text);var m=s+"-"+l;e[m]?(e[m].srclist.push(c),e[m].bigSrclist.push(u),e[m].text.push(g)):e[m]={year:s,month:l,srclist:[c],bigSrclist:[u],text:[g]}}i(e)},o=function(e){$(".open-ins").html("图片来自instagram，正在加载中…"),$.ajax({url:e,type:"GET",dataType:"jsonp",success:function(e){if(200==e.meta.code){t=t.concat(e.data);var i=e.pagination.next_url;i?o(i):($(".open-ins").html("图片来自instagram，点此访问"),n(t))}else alert("access_token timeout!")}})},r=function(){if($(document).width()<=600)$(".img-box").css({width:"auto",height:"auto"});else{var t=$(".img-box-ul").width(),e=Math.max(.26*t,157);$(".img-box").width(e).height(e)}},s=function(){$(window).resize(function(){r()})};return{init:function(){var t=$(".instagram").attr("data-client-id"),e=$(".instagram").attr("data-user-id");return t?e?(o("https://api.instagram.com/v1/users/"+e+"/media/recent/?client_id="+t+"&count=100"),void s()):(alert("Didn't set your instagram userid.\nPlease see the info on the console of your brower."),void console.log("Please open 'http://jelled.com/instagram/lookup-user-id' to get your userid.")):(alert("Didn't set your instagram client_id.\nPlease see the info on the console of your brower."),void console.log("Please open 'http://instagram.com/developer/clients/manage/' to get your client-id."))}}}();$(function(){Instagram.init()});